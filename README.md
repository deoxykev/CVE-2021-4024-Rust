# CVE-2021-4024-Rust
Linux LPE using polkit-1 written in Rust. 

## Usage
```
git clone https://github.com/deoxykev/CVE-2021-4024-Rust
cd CVE-2021-4024-Rust
cargo build --release
./target/release/cve-2021-4034-rust 

# whoami
root
```

## Opsec considerations
- Writes exploit files to /dev/shm (ramdisk)
  - delete randomly generated directory afterwards
  - can be detected on file creation
  - shellcode is hardcoded, consider replacing with a polymorphic payload
    (ie: msfvenom output)
- syscall to pkexec with null args can be detected

## Sigma Rule Detection
- https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_cve_2021_4034.yml

# Credits
vuln disclosure - qualsys research team - https://blog.qualys.com/vulnerabilities-threat-research/2022/01/25/pwnkit-local-privilege-escalation-vulnerability-discovered-in-polkits-pkexec-cve-2021-4034
shellcode - @johkrupp - https://saarsec.rocks/2020/05/14/golf.so.html
